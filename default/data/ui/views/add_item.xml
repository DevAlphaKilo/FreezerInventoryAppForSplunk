<form script="input-forms.js" stylesheet="input-forms.css">
  <label>Add Item</label>
  <fieldset submitButton="true" autoRun="false">
    <input type="dropdown" token="item">
      <label>Item Type</label>
      <choice value="meat">Meat</choice>
      <default>meat</default>
      <initialValue>meat</initialValue>
    </input>
    <input type="dropdown" token="subtype" searchWhenChanged="true">
      <label>Subtype</label>
      <fieldForLabel>type</fieldForLabel>
      <fieldForValue>type</fieldForValue>
      <search>
        <query>| inputlookup meat_types</query>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </search>
    </input>
    <input type="dropdown" token="cut_type" searchWhenChanged="true">
      <label>Cut Type</label>
      <fieldForLabel>cut_type</fieldForLabel>
      <fieldForValue>cut_type</fieldForValue>
      <search>
        <query>| inputlookup cut_types</query>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </search>
    </input>
    <input type="text" token="purchase_date" searchWhenChanged="true">
      <label>Purchase Date</label>
    </input>
    <input type="text" token="sealed_date" searchWhenChanged="true">
      <label>Sealed Date</label>
    </input>
    <input type="dropdown" token="cut_qty" searchWhenChanged="true">
      <label>Cut Quantity</label>
      <default>1</default>
      <initialValue>1</initialValue>
      <fieldForLabel>count</fieldForLabel>
      <fieldForValue>count</fieldForValue>
      <search>
        <query>| makeresults count=10
| streamstats count</query>
      </search>
    </input>
    <input type="dropdown" token="pack_qty" searchWhenChanged="true">
      <label>Pack Quantity</label>
      <default>1</default>
      <initialValue>1</initialValue>
      <fieldForLabel>count</fieldForLabel>
      <fieldForValue>count</fieldForValue>
      <search>
        <query>| makeresults count=10
| streamstats count</query>
      </search>
      <prefix>count=</prefix>
    </input>
  </fieldset>
  <row>
    <panel depends="$input_complete$">
      <title>Addition(s) Preview</title>
      <table>
        <search>
          <progress>
            <condition match="'job.resultCount' &gt; 0">
              <set token="input_complete">true</set>
            </condition>
            <condition>
              <unset token="input_complete"></unset>
            </condition>
          </progress>
          <query>| makeresults $pack_qty$
| streamstats count AS pack_id
| eval item="$item$", subtype="$subtype$", cut_type="$cut_type$", cut_qty="$cut_qty$"
| eval purchase_date=strftime(strptime("$purchase_date$", "%m/%d/%Y"), "%m/%d/%Y %H:%M:%S")
| eval sealed_date=strftime(strptime("$sealed_date$", "%m/%d/%Y"), "%m/%d/%Y %H:%M:%S")
| eval input_date=strftime(now(), "%m/%d/%Y %H:%M:%S") 
| eval item_id=sha512(pack_id + input_date + item + subtype + cut_type + purchase_date + sealed_date + cut_qty)
| table pack_id, item_id, input_date, item, subtype, cut_type, purchase_date, sealed_date, cut_qty</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
        <input id="submit_button" type="button" value="Submit Input"/>
      </html>
    </panel>
  </row>
</form>